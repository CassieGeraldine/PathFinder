<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rewards - Empiras Vanguard</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/navbar.css">
    <link rel="stylesheet" href="../css/footer.css">
    <link rel="stylesheet" href="../css/rewards.css">
    <script src="../database.js"></script>
    <script src="../js/rewards.js"></script>
    <script src="../js/script.js" defer></script>
    <script src="../js/navbar.js" defer></script>
    <script src="../js/footer.js" defer></script>
</head>
<body data-role="student">
    <!-- Navbar -->
    <header id="navbar"></header>

    <main class="rewards-container">
        <div class="rewards-header">
            <h1>üèÜ Rewards Store</h1>
            <div class="points-display">
                <span class="points-icon">‚≠ê</span>
                <span class="points-amount" id="totalPoints">1000</span>
                <span class="points-label">Points</span>
            </div>
        </div>

        <div class="rewards-content">
            <!-- Redeemed Items -->
            <div class="redeemed-section">
                <h2>Your Rewards</h2>
                <div class="redeemed-items" id="redeemedItems">
                    <div class="empty-state">No rewards redeemed yet. Start earning points!</div>
                </div>
            </div>

            <!-- Available Rewards -->
            <div class="available-section">
                <h2>Available Rewards</h2>
                <div class="rewards-grid">
                    <div class="reward-item" data-cost="50" data-name="Homework Pass" data-description="Skip one homework assignment">
                        <div class="reward-icon">üìù</div>
                        <div class="reward-info">
                            <h3>Homework Pass</h3>
                            <p>Skip one homework assignment</p>
                            <div class="reward-cost">50 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="75" data-name="Extra Credit" data-description="Get 5% extra credit on next test">
                        <div class="reward-icon">üìö</div>
                        <div class="reward-info">
                            <h3>Extra Credit</h3>
                            <p>Get 5% extra credit on next test</p>
                            <div class="reward-cost">75 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="100" data-name="Lunch with Teacher" data-description="Have lunch with your favorite teacher">
                        <div class="reward-icon">üçï</div>
                        <div class="reward-info">
                            <h3>Lunch with Teacher</h3>
                            <p>Have lunch with your favorite teacher</p>
                            <div class="reward-cost">100 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="125" data-name="Library Privileges" data-description="Extended library access for a week">
                        <div class="reward-icon">üìñ</div>
                        <div class="reward-info">
                            <h3>Library Privileges</h3>
                            <p>Extended library access for a week</p>
                            <div class="reward-cost">125 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="150" data-name="Computer Lab Time" data-description="Extra computer lab time after school">
                        <div class="reward-icon">üíª</div>
                        <div class="reward-info">
                            <h3>Computer Lab Time</h3>
                            <p>Extra computer lab time after school</p>
                            <div class="reward-cost">150 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="200" data-name="School Store Voucher" data-description="R50 voucher for school store">
                        <div class="reward-icon">üõçÔ∏è</div>
                        <div class="reward-info">
                            <h3>School Store Voucher</h3>
                            <p>R50 voucher for school store</p>
                            <div class="reward-cost">200 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="250" data-name="Front of Line Pass" data-description="Skip to front of lunch line for a week">
                        <div class="reward-icon">ü•™</div>
                        <div class="reward-info">
                            <h3>Front of Line Pass</h3>
                            <p>Skip to front of lunch line for a week</p>
                            <div class="reward-cost">250 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>

                    <div class="reward-item" data-cost="300" data-name="Principal's Office Visit" data-description="Meet with principal for positive recognition">
                        <div class="reward-icon">üëî</div>
                        <div class="reward-info">
                            <h3>Principal's Office Visit</h3>
                            <p>Meet with principal for positive recognition</p>
                            <div class="reward-cost">300 points</div>
                        </div>
                        <button class="redeem-btn" onclick="redeemReward(this)">Redeem</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Confirm Modal -->
        <div id="redeemModal" class="modal">
            <div class="modal-content">
                <h3>Confirm Redemption</h3>
                <div class="reward-preview">
                    <div class="reward-icon" id="modalRewardIcon"></div>
                    <div class="reward-details">
                        <h4 id="modalRewardName"></h4>
                        <p id="modalRewardDescription"></p>
                        <p>Cost: <strong id="modalRewardCost"></strong> points</p>
                        <p>Your balance: <strong id="modalUserBalance"></strong> points</p>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn-primary" onclick="confirmRedeem()">Yes, Redeem!</button>
                    <button class="btn-secondary" onclick="hideRedeemModal()">Cancel</button>
                </div>
                <span class="close" onclick="hideRedeemModal()">&times;</span>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="successModal" class="modal">
            <div class="modal-content">
                <h3>üéâ Success!</h3>
                <p id="successMessage"></p>
                <button class="btn-primary" onclick="hideSuccessModal()">Great!</button>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer id="footer"></footer>

    <script>
        // Load components when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadComponent('../components/navbar.html', 'navbar');
            loadComponent('../components/footer.html', 'footer');
        });

        // Component loader function
        async function loadComponent(componentPath, targetElementId) {
            try {
                const response = await fetch(componentPath);
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const bodyContent = doc.body.innerHTML;
                document.getElementById(targetElementId).innerHTML = bodyContent;
                
                if (targetElementId === 'navbar') {
                    setTimeout(() => {
                        if (typeof initializeNavbar === 'function') {
                            initializeNavbar();
                        }
                    }, 50);
                }
            } catch (error) {
                console.error(`Error loading component ${componentPath}:`, error);
            }
        }
    </script>
</body>
</html>
